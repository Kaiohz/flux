# apiVersion: helm.toolkit.fluxcd.io/v2beta1
# kind: HelmRelease
# metadata:
#   name: prospection-api-mcp
#   namespace: kaiohz
# spec:
#   serviceAccountName: admin
#   interval: 2m
#   releaseName: prospection-api-mcp
#   timeout: 300s
#   chart:
#     spec:
#       chart: ./chart
#       sourceRef:
#         kind: GitRepository
#         name: prospection-api-mcp
#   test:
#     enable: true
#     ignoreFailures: false
#     timeout: 30s
#   rollback:
#     disableHooks: true
#     force: true
#     recreate: true
#     timeout: 300s
#   values:
#     fqdn: agent-api.stg.apps.web.bpifrance.fr
#     fullnameOverride: prospection-api-mcp
#     labels:
#       environment: dev
#     selectorLabels:
#       app: prospection-api-mcp
#     image:
#       repository: artifactory.laforge.cloud.bpifrance.fr/mta-docker-snapshot/agent-api
#       tag: b63347df2f4e0ec596dc0da32b2b53ce0aaffb64
#     replicaCount: 1
#     containerPort: 8000
#     livenessProbe:
#       path: /docs
#       initialDelaySeconds: 30
#       periodSeconds: 10
#       failureThreshold: 10
#     readinessProbe:
#       path: /docs
#       initialDelaySeconds: 30
#       periodSeconds: 10
#       failureThreshold: 10
#     podSecurityContext:
#       runAsNonRoot: true
#       runAsUser: 1001
#       runAsGroup: 1001
#       fsGroup: 1001
#     resources:
#       requests:
#         cpu: 250m
#         memory: 250Mi
#       limits:
#         cpu: 500m
#         memory: 500Mi
#     nodeSelector: {
#       light: "true"
#     }
#     envFrom:
#       secrets:
#         - secretRef: prospection-api-mcp-secret
#       configMaps:
#         - configMapRef: prospection-api-mcp-configmap
#     networkPolicy:
#       create: true
#       policyTypes:
#         - Ingress
#         - Egress
#       ingress:
#         - ports:
#             - protocol: TCP
#               port: 8000
#             - protocol: TCP
#               port: 443
#             - protocol: TCP
#               port: 80
#       egress:
#         - ports:
#             - port: 3128
#               protocol: TCP
#             - port: 24732
#               protocol: TCP
#             - port: 443
#               protocol: TCP
#             - port: 80
#               protocol: TCP
#     service:
#       type: ClusterIP
#       port: 80
#       targetPort: 8000
#     autoscaling:
#       enabled: true
#       minReplicas: 1
#       maxReplicas: 1
#       targetCPUUtilizationPercentage: 60
#       targetMemoryUtilizationPercentage: 60
#     secret:
#       name: prospection-api-mcp-secret
#     configMap:
#       name: prospection-api-mcp-configmap
#       data:

